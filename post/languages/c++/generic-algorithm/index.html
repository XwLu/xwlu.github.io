<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://xwlu.github.io/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://xwlu.github.io/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://xwlu.github.io/css/github.min.css' />
    <link rel="stylesheet" href='https://xwlu.github.io/css/github-style.css' />
    <link rel="stylesheet" href='https://xwlu.github.io/css/light.css' />
    <link rel="stylesheet" href='https://xwlu.github.io/css/dark.css' />
    <link rel="stylesheet" href='https://xwlu.github.io/css/syntax.css' />
    <title>Generic Algorithm - My New Hugo Site</title>
    
    <link rel="icon" type="image/x-icon" href='/images/github.png'>
    
    <meta name="theme-color" content="#1e2327">

    <link rel="stylesheet" href="https://xwlu.github.io/css/custom.css">
    <script type="text/javascript" src="https://xwlu.github.io/js/custom.js"></script>

    
    <meta name="description"
  content="generic algorithm for C&#43;&#43;" />
<meta name="keywords"
  content='blog, robotics' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://xwlu.github.io/post/languages/c&#43;&#43;/generic-algorithm/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Generic Algorithm - My New Hugo Site" />
<meta name="twitter:description"
  content="generic algorithm for C&#43;&#43;" />
<meta name="twitter:site" content="https://xwlu.github.io/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://xwlu.github.io/">


<meta property="og:type" content="article" />
<meta property="og:title" content="Generic Algorithm - My New Hugo Site">
<meta property="og:description"
  content="generic algorithm for C&#43;&#43;" />
<meta property="og:url" content="https://xwlu.github.io/post/languages/c&#43;&#43;/generic-algorithm/" />
<meta property="og:site_name" content="Generic Algorithm" />
<meta property="og:image"
  content="https://xwlu.github.io/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2025-04-02 10:32:39 &#43;0800 CST" />











</head>


<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="https://xwlu.github.io/">
        <img class="octicon" height="32" width="32" src="/images/github-mark-white.png">
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:https://xwlu.github.io/">
            </label>
          </form>
          
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="https://xwlu.github.io/">
        <img class="octicon octicon-mark-github v-align-middle" height="32" width="32" src="/images/github-mark-white.png">
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>

  <div id="search-result" class="container-lg px-3 new-discussion-timeline" style="display: none;">
</div>

  
<div class="application-main">
  <div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://xwlu.github.io/">
                  <img class=" avatar-user"
                    src="/images/avatar.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://xwlu.github.io/">looyifan</a>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="https://xwlu.github.io/post/languages/c&#43;&#43;/generic-algorithm/">Generic Algorithm</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Wed, 02 Apr 2025 10:32:39 &#43;0800"
                    class="no-wrap">
                    Wed, 02 Apr 2025 10:32:39 &#43;0800</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Wed, 02 Apr 2025 17:02:27 &#43;0800"
                    class="no-wrap">
                    Wed, 02 Apr 2025 17:02:27 &#43;0800</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      1818 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><h1 id="泛型算法简介">泛型算法简介</h1>
<ul>
<li>我们把一些常用的简单的算法抽象出来，然后用不同的迭代器去调用这些函数，这些算法被称为泛型算法</li>
<li>C++标准库中的泛型算法：algorithm, numeric, ranges</li>
<li>泛型算法的实现都不复杂，但优化足够好</li>
<li>一些泛型算法与方法同名，实现功能类似，此时建议调用方法而非算法
<ul>
<li>std::find VS. std::map::find</li>
<li>方法会根据对应数据结构的特性做优化，而泛型算法为了确保通用性，不会做特定优化</li>
</ul>
</li>
</ul>
<hr>
<h1 id="泛型算法分类">泛型算法分类</h1>
<ul>
<li>读算法：给定迭代区间，读取其中的元素并进行计算
<ul>
<li>accumulate/find/count</li>
</ul>
</li>
<li>写算法：向迭代器中写入元素
<ul>
<li>单纯写：fill/fill_n</li>
<li>读+写：transform/copy</li>
<li>注意：写算法一定要保证目标区间足够大</li>
</ul>
</li>
<li>排序算法：改变输入序列中元素的顺序
<ul>
<li>sort/unique</li>
<li>注意unique的用法，只把原序列中连在一起的相同元素合并为1个</li>
</ul>
</li>
</ul>
<hr>
<h1 id="迭代器的分类">迭代器的分类</h1>
<ul>
<li>泛型算法使用迭代器实现元素访问</li>
<li>常见迭代器
<ul>
<li>输入迭代器：可读，可递增，典型应用是find算法</li>
<li>输出迭代器：可写，可递增，典型应用是copy算法</li>
<li>前向迭代器：可读写，可递增，典型应用是replace算法</li>
<li>双向迭代器：可读写，可递增递减，典型应用是reverse算法</li>
<li>随机访问迭代器：可读写，可增减一个整数，典型应用是sort算法</li>
</ul>
</li>
<li>一些算法会根据迭代器的类别不同引入相应的优化
<ul>
<li>distance算法
<ul>
<li>如果输入的是输入迭代器，就只能通过++的方式计算两个迭代器之间的距离</li>
<li>如果输入的是随机访问迭代器，就可以直接用last_it - begin_it得到距离</li>
</ul>
</li>
</ul>
</li>
<li>特殊的迭代器
<ul>
<li>插入迭代器：back_insert_iterator(back_inserter), front_insert_iterator(front_inseter), insert_iterator(inserter)
<pre tabindex="0"><code>std::vector&lt;int&gt; x;
std::fill_n(x.begin(), 10, 3);  // core，因为x的内存比10小
std::fill_n(std::back_insert_iterator&lt;std::vector&lt;int&gt;&gt;(x), 10, 3);  // 正确，因为back_insert_iterator把&#34;=&#34;操作重载为push_back了，所以这里能正确往x中填充10个3
std::fill_n(std::back_inserter(x), 10, 3);  // 简化版本
for (const auto i : x) {
  std::cout &lt;&lt; i &lt;&lt; &#34; &#34;;
}
std::cout &lt;&lt; std::endl;
</code></pre></li>
<li>流迭代器
<ul>
<li>istream_iterator
<pre tabindex="0"><code>std::istringstream str(&#34;1 2 3 4 5&#34;);
std::istream_iterator&lt;int&gt; x(str);
std::cout &lt;&lt; *x &lt;&lt; std::endl;  // 1
++x;
std::cout &lt;&lt; *x &lt;&lt; std::endl;  // 2

std::istream_iterator&lt;int&gt; y{};  // 这一行不是类对象的定义，而是函数声明
// std::istream_iterator&lt;int&gt; y;  // 这么写也可以
for (; x != y; ++x) {
  std::cout &lt;&lt; *x &lt;&lt; std::endl;  // 1 2 3 4 5
}
std::accumulate(x, y, 0);  // 15
</code></pre></li>
<li>ostream_iterator
<pre tabindex="0"><code>std::vector&lt;int&gt; x{1, 2, 3};
std::copy(x.rbegin(), y.rbegin(), std::ostream_iterator&lt;int&gt;(std::cout, &#34; &#34;));
</code></pre></li>
</ul>
</li>
<li>反向迭代器</li>
<li>移动迭代器
<ul>
<li>move_iterator：功能类似于move操作，执行后原先内存的内容就没了</li>
</ul>
</li>
</ul>
</li>
<li>迭代器与哨兵(Sentinel)
<ul>
<li>哨兵一般指标识迭代器结束的标志，比如vector.end(), 以及上面的std::istream_iterator&lt;int&gt; y{}，都是哨兵</li>
<li>哨兵在ranges算法中是个非常重要的概念</li>
</ul>
</li>
</ul>
<hr>
<h1 id="并发算法c1720">并发算法(C++17/20)</h1>
<ul>
<li>有些算法可以通过指定执行policy来加速，下面是一些policy的举例
<ul>
<li>std::execution::seq：顺序执行</li>
<li>std::execution::par：并发执行</li>
<li>std::execution::par_unseq：并发非顺序执行</li>
<li>std::execution::unseq：非顺序执行</li>
</ul>
</li>
<li>代码demo(注意：下面的代码可能需要在编译时加上-o3和-ltbb库的优化才能体现出加速效果)
<pre tabindex="0"><code>#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;chrono&gt;
#include &lt;random&gt;
#include &lt;ratio&gt;
#include &lt;vector&gt;
#include &lt;execution&gt;

int main() {
  std::random_device rd;
  std::vector&lt;double&gt; vals(100000000);
  for (auto&amp; d : vals) {
    d = static_cast&lt;int&gt;(rd());
  }

  for (int i = 0; i &lt; 5; ++i) {
    using namespace std::chrono;
    std::vector&lt;double&gt; sorted(vals);
    const auto startTime = high_resolution_clock::now();
    std::sort(std::execution::par, sorted.begin(), sorted.end());  // 并发执行，加速
    std::sort(std::execution::unseq, sorted.begin(), sorted.end());  // 顺序执行，不加速
    const auto endTime = high_resolution_clock::now();
    std::cout &lt;&lt; &#34;Latency: &#34; &lt;&lt; duration_cast&lt;duration&lt;double, std::milli&gt;&gt;(endTime - startTime).count() &lt;&lt; std::endl;
  }
  return 1;
}
</code></pre></li>
</ul>
<hr>
<h1 id="泛型算法的改进rangesc20">泛型算法的改进&ndash;ranges(C++20)</h1>
<ul>
<li>ranges可以视为C++标准模块库的2.0版本</li>
<li>可以使用容器而非迭代器做为输入
<pre tabindex="0"><code>int main() {
  std::vector&lt;int&gt; x{1, 2, 3, 4, 5};
  auto it = std::find(x.begin(), x.end(), 3);
  it = std::ranges::find(x.begin(), x.end(), 3);
  it = std::ranges::find(x, 3);
  std::cout &lt;&lt; *it &lt;&lt; std::endl;
}
</code></pre><ul>
<li>通过std::ranges::dangling避免返回无效的迭代器</li>
</ul>
</li>
<li>引入映射概念，简化代码编写
<pre tabindex="0"><code>std::map&lt;int, int&gt; m{{2, 3}};
auto it = std::ranges::find(m.begin(), m.end(), 3, &amp;std::pair&lt;const int, int&gt;::second);  // projectionii，本质上是个指针，指向了pair的第二个元素
std::cout &lt;&lt; it-&gt;first &lt;&lt; std::endl;
</code></pre></li>
<li>引入view，灵活组织程序逻辑
<ul>
<li>通过 | 这样的符号串联起来组成更加复杂的语句，这个在container部分有讲</li>
</ul>
</li>
<li>从类型上区分迭代器与哨兵</li>
</ul>
<hr>
<h1 id="demo">Demo</h1>
<ul>
<li>
<p>sort排序</p>
<pre tabindex="0"><code>vector&lt;Struct&gt; A
bool f1 (Struct a,Struct b) { return (a.x&gt;b.x); }
bool f2 (Struct a,Struct b) { return (a.x&lt;b.x); }
sort(A.begin(), A.end(), f1);//降序排列
sort(A.begin(), A.end(), f2);//升序排列
sort(A.begin(), A.end(), \[\](const struct&amp; A, const struct&amp; B){return A.a &lt; B.b;})

//cmp函数需要输入额外变量时
bool f3(Struct a, Struct b, double c){
    if(a.y - b.y &gt; c){
        return a.x &lt; b.x;
    }else{
        return a.x &gt; b.x;
    }
}
double c = 10;
sort(A.begin(), A.end(), std::bind(f3,
                                    std::placeholders::_1,
                                    std::placeholders::_2,
                                    c));
</code></pre></li>
<li>
<p>nth_element函数</p>
<pre tabindex="0"><code>vector&lt;int&gt; pts;
//只保证pts[6]是排名第6的元素,同时pts[0-5]&lt;pts[6],pts[6-end]&gt;pts[6]
nth_element(pts.begin(), pts.begin()+6; pts.end())

compare(Ponit2d* a, Ponit2d* b)
{
  return(a-&gt;x &lt; b-&gt;x);
}
vector&lt;point2d&gt; pts;
nth_element(pts.begin(), pts.begin()+6; pts.end(), compare);
</code></pre></li>
<li>
<p>lower_bound</p>
<pre tabindex="0"><code>auto compare_s = [](const std::pair&lt;double, double&gt;&amp; point, const double s) {
    return point.first &lt; s;
};
vector&lt;pair&lt;double, double&gt;&gt; var;
auto it_lower = std::lower_bound(var.begin(),
                                var.end(), s, compare_s);
</code></pre></li>
<li>
<p>for_each</p>
<pre tabindex="0"><code>void add(int&amp; lhs) {
  lhs= lhs + 1;
}
for_each(intVector.begin(),intVector.end(),add);

void add(int&amp; lhs,int rhs) {
  lhs= lhs + rhs;
}
for_each(intVector.begin(),intVector.end(),boost::bind(add,_1,100));
</code></pre></li>
</ul>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://xwlu.github.io/js/toc.js'></script>
<link rel="stylesheet" href='https://xwlu.github.io/css/toc.css' />

  
<div id="gitalk-container" class="gitalk-container"></div>
<link rel="stylesheet" href='https://xwlu.github.io/css/gitalk.css'>
<script src='https://xwlu.github.io/js/gitalk.min.js'></script>
<script>
  const gitalk = new Gitalk({
    clientID: '',
    clientSecret: '',
    repo: '',
    owner: '',
    admin: [''],
    id: eval( null ), 
    distractionFreeMode: false 
  });
  (function() {
    gitalk.render('gitalk-container');
  })();
</script>

</div>

  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://xwlu.github.io/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
      <li class="mr-3 mr-lg-0">GitHub and the Invertocat logo are trademarks of <a href="https://github.com/">GitHub, Inc.</a></li>
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>

</body>

<script type="application/javascript" src="https://xwlu.github.io/js/github-style.js"></script>







</html>